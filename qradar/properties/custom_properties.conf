# QRadar Custom Properties Configuration
# BSI-Grundschutz Compliant SIEM Implementation
# Author: Security Operations Team
# Last Updated: 2024-01-01

# Authentication Event Categories
authentication_event_category=select * from events where eventname MATCHES '.*[Aa]uth.*'

# Failed Login Monitoring
failed_login_count=select sourceip, count(*) from events where eventname='Authentication Failed' and eventtime > (NOW() - INTERVAL '1' HOUR) group by sourceip

# Suspicious Domains
suspicious_domains=select * from flows where hostname MATCHES '.*\.tk' OR hostname MATCHES '.*\.ml' OR hostname MATCHES '.*\.bit'

# PCI CDE Access Events
pci_cde_access=select * from events where filename MATCHES '.*cardholder.*' OR filename MATCHES '.*payment.*' OR filename MATCHES '.*card.*'

# BSI Grundschutz System Events
bsi_system_events=select * from events where eventname MATCHES '.*Policy.*' OR eventname MATCHES '.*Configuration.*'

# APT Spear-Phishing Indicators
apt_spearphish_indicators=select * from events where category=11002 and ("E-Mail Subject" MATCHES '.*[Dd]ringend.*' or "Sender Display Name" MATCHES '.*Bundesamt.*') and "Has Attachment"='true'

# Privilege Escalation Events
privilege_event_category=select * from events where eventname MATCHES '.*[Pp]rivilege.*' OR eventname MATCHES '.*[Aa]dmin.*'

# Data Exfiltration Monitoring
data_exfiltration_monitor=select sourceip, destinationip, sum(bytessent) from flows where bytessent > 10485760 and eventtime > (NOW() - INTERVAL '1' HOUR) group by sourceip, destinationip
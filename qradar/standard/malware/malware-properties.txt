# Malware Communication Custom Properties
# Suspicious Domains
suspicious_domains=select * from flows where hostname MATCHES '.*\.tk' OR hostname MATCHES '.*\.ml' OR hostname MATCHES '.*\.bit' OR hostname MATCHES '.*pastebin\.com.*'

# C2 Communication Patterns
c2_patterns=select sourceip, destinationip, count(*) from flows where destinationport IN (8080,1337,6667) and eventtime > (NOW() - INTERVAL '24' HOUR) group by sourceip, destinationip having count(*) > 10

# Beacon Analysis
beacon_analysis=select sourceip, destinationip, AVG(bytessent) as avg_bytes, COUNT(*) as connection_count from flows where eventtime > (NOW() - INTERVAL '1' HOUR) group by sourceip, destinationip having COUNT(*) > 20 AND AVG(bytessent) < 1000

# DGA Domain Detection
dga_domains=select hostname, count(*) from flows where LENGTH(hostname) > 20 AND hostname MATCHES '.*[0-9].*[a-z].*[0-9].*' group by hostname having count(*) > 5